(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[365],{2634:e=>{e.exports={button:"Button_button__0jeRB",spinner:"Button_spinner__04DdI",spin:"Button_spin__2hDYC",primary:"Button_primary__jPHf0",secondary:"Button_secondary__Mx7QC",danger:"Button_danger__6AANl",sm:"Button_sm__BiPCv",md:"Button_md__M9HW6",lg:"Button_lg__Cj2rS"}},4236:(e,t,r)=>{"use strict";r.d(t,{A:()=>n});var o=r(5731);let n=()=>(0,o.Z)()},4545:e=>{e.exports={container:"auth_container__RCjrp",form:"auth_form__5hAbJ",header:"auth_header__EAJtM",errorMessage:"auth_errorMessage__dJBhp",footer:"auth_footer__kG3Bd"}},5354:(e,t,r)=>{"use strict";r.d(t,{A:()=>s});var o=r(5155);r(2115);var n=r(2634),a=r.n(n);let s=e=>{let{children:t,variant:r="primary",size:n="md",loading:s=!1,disabled:l,className:i="",...c}=e,u=l||s;return(0,o.jsxs)("button",{className:"".concat(a().button," ").concat(a()[r]," ").concat(a()[n]," ").concat(i),disabled:u,...c,children:[s&&(0,o.jsx)("span",{className:a().spinner}),t]})}},5731:(e,t,r)=>{"use strict";r.d(t,{AuthProvider:()=>s,Z:()=>l});var o=r(5155),n=r(2115);let a=(0,n.createContext)(void 0),s=e=>{let{children:t}=e,[r,s]=(0,n.useState)(null),[l,i]=(0,n.useState)(!0);return(0,n.useEffect)(()=>{let e=setTimeout(()=>{try{{let e=localStorage.getItem("user");if(e){let t=JSON.parse(e);s(t)}}}catch(e){console.error("Failed to parse user from localStorage",e),localStorage.removeItem("user")}finally{i(!1)}},100);return()=>clearTimeout(e)},[]),(0,o.jsx)(a.Provider,{value:{user:r,login:e=>{s(e),localStorage.setItem("user",JSON.stringify(e))},logout:()=>{s(null),localStorage.removeItem("user")},isLoading:l},children:t})},l=()=>{let e=(0,n.useContext)(a);if(!e)throw Error("useAuthContext must be used within AuthProvider");return e}},7498:(e,t,r)=>{Promise.resolve().then(r.bind(r,8911))},8911:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>x});var o=r(5155),n=r(2115),a=r(2177),s=r(221),l=r(5695),i=r(9711),c=r.n(i);let u=(0,n.forwardRef)((e,t)=>{let{label:r,error:n,className:a="",...s}=e;return(0,o.jsxs)("div",{className:c().container,children:[r&&(0,o.jsx)("label",{className:c().label,children:r}),(0,o.jsx)("input",{ref:t,className:"".concat(c().input," ").concat(n?c().errorInput:""," ").concat(a),...s}),n&&(0,o.jsx)("p",{className:c().error,children:n})]})});u.displayName="Input";var d=r(5354),_=r(4236),h=r(8309);let m=h.Ik({phone:h.Yj().min(1,"شماره همراه الزامی است").regex(/^09\d{9}$/,{message:"شماره همراه باید 11 رقم باشد و با 09 شروع شود"})});var p=r(4545),v=r.n(p),f=r(1890);function x(){var e;let{register:t,handleSubmit:r,formState:{errors:i,isSubmitting:c}}=(0,a.mN)({resolver:(0,s.u)(m),mode:"onChange"}),h=(0,l.useRouter)(),{login:p,user:x,isLoading:g}=(0,_.A)(),[j,N]=(0,n.useState)("");(0,n.useEffect)(()=>{!g&&x&&h.push("/dashboard")},[x,g,h]);let b=async e=>{N("");try{var t,r,o,n,a,s,l,i;let c=f.env.NEXT_PUBLIC_BASE_PATH||"/my-auth",u=await fetch("".concat(c,"/api.json"));if(!u.ok)throw Error("HTTP error! status: ".concat(u.status));let d=await u.json();if(!d.results||0===d.results.length)throw Error("No user data received");let _=d.results[0],m={id:(null==(t=_.login)?void 0:t.uuid)||Math.random().toString(36),name:"".concat((null==(r=_.name)?void 0:r.first)||""," ").concat((null==(o=_.name)?void 0:o.last)||"").trim(),email:_.email||"user".concat(Date.now(),"@example.com"),phone:e.phone,picture:_.picture||void 0,gender:_.gender,location:{street:null==(n=_.location)?void 0:n.street,city:null==(a=_.location)?void 0:a.city,state:null==(s=_.location)?void 0:s.state,country:null==(l=_.location)?void 0:l.country,postcode:null==(i=_.location)?void 0:i.postcode},dob:_.dob,cell:_.cell};p(m),h.push("/dashboard")}catch(e){console.error("Auth error:",e),N(e instanceof Error?"خطا در بارگذاری اطلاعات: ".concat(e.message):"خطا در دریافت اطلاعات کاربر. لطفاً دوباره تلاش کنید.")}};return g?(0,o.jsx)("div",{className:v().container,children:(0,o.jsx)("div",{className:v().form,children:(0,o.jsx)("div",{style:{textAlign:"center"},children:"در حال بارگذاری..."})})}):(0,o.jsx)("main",{className:v().container,children:(0,o.jsxs)("form",{onSubmit:r(b),className:v().form,children:[(0,o.jsxs)("div",{className:v().header,children:[(0,o.jsx)("h1",{children:"ورود به حساب کاربری"}),(0,o.jsx)("p",{children:"لطفاً شماره همراه خود را وارد کنید"})]}),(0,o.jsx)(u,{label:"شماره همراه",placeholder:"مثال: 09123456789",type:"tel",...t("phone"),error:null==(e=i.phone)?void 0:e.message}),j&&(0,o.jsx)("div",{className:v().errorMessage,children:j}),(0,o.jsx)(d.A,{type:"submit",loading:c,disabled:c,size:"lg",children:c?"در حال ورود...":"ورود"}),(0,o.jsx)("div",{className:v().footer,children:(0,o.jsx)("p",{children:"با کلیک روی دکمه ورود، شرایط استفاده را می‌پذیرید."})})]})})}},9711:e=>{e.exports={container:"Input_container__JT30C",label:"Input_label__SDMwM",input:"Input_input__tO_sx",errorInput:"Input_errorInput__wK8T6",error:"Input_error__J6z3J"}}},e=>{e.O(0,[417,583,441,964,358],()=>e(e.s=7498)),_N_E=e.O()}]);